<!-- # File: betterboxd/templates/betterboxd/movie.html -->
<!-- # Author: David Myat (amyat@bu.edu), 12/2/2025 -->
<!-- # Description: movie template for betterboxd project -->

{% extends 'betterboxd/base.html' %}

{% block content %}

<h1>Movie Detail</h1>

<div>
    <div class="movie-box">
        {% if movie.poster %}
            <img src="{{ movie.poster }}" alt="{{ movie.title }} Poster" class="movie-poster">
        {% endif %}
        <h2>{{ movie.title }}</h2>
        <p><strong>Release Year:</strong> {{ movie.year }}</p>
        <p><strong>Genre:</strong> {{ movie.genre }}</p>
        <p><strong>Director:</strong> {{ movie.director }}</p>
        <p><strong>Runtime:</strong> {{ movie.runtime }} minutes</p>
        <p><strong>Description:</strong> {{ movie.description }}</p>

        <div class="movie-button">
            <a href="{% url 'create_review' pk=movie.pk %}" class="betterboxd-button">Add a Review</a>
            {% if user.is_authenticated %}
                {% if is_in_watchlist %}
                    <a href="{% url 'remove_from_watchlist' pk=movie.pk %}" class="betterboxd-button">Remove from Watchlist</a>
                {% else %}
                    <a href="{% url 'add_to_watchlist' pk=movie.pk %}" class="betterboxd-button">Add to Watchlist</a>
                {% endif %}
            {% endif %}
        </div>
    </div>
</div>

<h3>Reviews</h3>
<div class="reviews-section">
    {% for review in movie.review_set.all %}
        <div class="review-box">
            <p><strong>{{ review.user.username }}</strong></p>
            <p>{{ review.review_text }}</p>
            <p>Rating: {{ review.rating }} / 5 ‚≠ê</p>
        </div>
        {% if user.is_authenticated and review.user == user %}
            <div>
                <a href="{% url 'update_review' pk=review.pk %}" class="betterboxd-button">Edit</a>
                <a href="{% url 'delete_review' pk=review.pk %}" class="betterboxd-button">Delete</a>
            </div>
        {% endif %}
    {% empty %}
        <p>No reviews yet. Be the first to review this movie!</p>
    {% endfor %}
</div>

{% endblock %}
